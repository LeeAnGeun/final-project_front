<!DOCTYPE html>
<html>
<head>
      <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>ACLAP</title>
        
   
<!-- jquary -->
<script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- pagination -->
<script type="text/javascript" src="../js/jquery.twbsPagination.min.js"></script>

<!-- icon -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js" crossorigin="anonymous"></script>

<script src="https://smtpjs.com/v3/smtp.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>

<!-- script -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="../js/scripts.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>

<!-- pagination -->
<script type="text/javascript" src="../js/jquery.twbsPagination.min.js"></script>

<script type="text/javascript">
(function() {
emailjs.init("user_ZyFYDtGep3QSZfIgncD2e");
})();
</script>

<style type="text/css">
.card mb-4{
	width: 80%
}	
#layoutSidenav{
	width: 100%;
	height: 100vh;
	position: relative;
	margin: 0auto;
	
}
	
	
#layoutSidenav #layoutSidenav_nav{
	width: 10%;
	height: 100%;
	float: left;
	position: relative;
	/* border: dashed;
	border-color: red; */
}
	
	
	
#layoutSidenav #layoutSidenav_content{
	width: 90%;
	height: 100%;
	float: left;
	position: relative;
	/* border: dashed;
	border-color: red; */
}
	

.sb-sidenav {
padding-top: 200px;
  display: flex;
  flex-direction: column;
  height: 100%;
  flex-wrap: nowrap;
}

.sb-sidenav .sb-sidenav-menu {
  flex-grow: 1;
}
.sb-sidenav .sb-sidenav-menu .nav {
  flex-direction: column;
  flex-wrap: nowrap;
}
.sb-sidenav .sb-sidenav-menu .nav .sb-sidenav-menu-heading {
  padding: 1.75rem 1rem 0.75rem;
  font-size: 0.75rem;
  font-weight: bold;
  text-transform: uppercase;
}
.sb-sidenav .sb-sidenav-menu .nav .nav-link {
  display: flex;
  align-items: center;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  position: relative;
}
.sb-sidenav .sb-sidenav-menu .nav .nav-link .sb-nav-link-icon {
  font-size: 0.9rem;
}
.sb-sidenav .sb-sidenav-menu .nav .nav-link .sb-sidenav-collapse-arrow {
  display: inline-block;
  margin-left: auto;
  transition: transform 0.15s ease;
}
.sb-sidenav .sb-sidenav-menu .nav .nav-link.collapsed .sb-sidenav-collapse-arrow {
  transform: rotate(-90deg);
}
.sb-sidenav .sb-sidenav-menu .nav .sb-sidenav-menu-nested {
  margin-left: 1.5rem;
  flex-direction: column;
}
.sb-sidenav .sb-sidenav-footer {
  padding: 0.75rem;
  flex-shrink: 0;
}

.sb-sidenav-dark {
  background-color: #212529;
  color: rgba(255, 255, 255, 0.5);
}
.sb-sidenav-dark .sb-sidenav-menu .sb-sidenav-menu-heading {
  color: rgba(255, 255, 255, 0.25);
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link {
  color: rgba(255, 255, 255, 0.5);
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link .sb-nav-link-icon {
  color: rgba(255, 255, 255, 0.25);
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link .sb-sidenav-collapse-arrow {
  color: rgba(255, 255, 255, 0.25);
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link:hover {
  color: #fff;
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link.active {
  color: #fff;
}
.sb-sidenav-dark .sb-sidenav-menu .nav-link.active .sb-nav-link-icon {
  color: #fff;
}
.sb-sidenav-dark .sb-sidenav-footer {
  background-color: #343a40;
}
.table-responsive::-webkit-scrollbar{
	display: none; /* Chrome, Safari, Opera*/
}
div.mainTable{
	width: 100%;
	height: 80%;
	position: relative;
	float: center;
	
}
table.customTable {
  width: 70%;
  background-color: #FFFCE6;
  border-collapse: collapse;
  border-width: 2px;
  border-color: #FFFFFF;
  border-style: groove;
  color: #000000;
  margin: auto;
 
}

table.customTable td, table.customTable th {
  border-width: 2px;
  border-color: #FFFFFF;
  border-style: groove;
  padding: 5px;
}

table.customTable thead {
  background-color: #F8EB95;
}






div.mainTable{

	height: 80%;
	position: relative;
	float: center;
	
}
table.customTable {
  width: 70%;
  background-color: #FFFCE6;
  border-collapse: collapse;
  border-width: 2px;
  border-color: #FFFFFF;
  border-style: groove;
  color: #000000;
  margin: auto;
 
}

table.customTable td, table.customTable th {
  border-width: 2px;
  border-color: #FFFFFF;
  border-style: groove;
  padding: 5px;
}

table.customTable thead {
  background-color: #F8EB95;
}



#noticeCheckCheck{
    display: none;
    width: 100vw;
    margin-left: 80px;
    position: relative;
}

#layoutSidenav_content{
	display: none;
}

.delClass{
	background-color:white;
	border:none;
}
.reStartClass{
	background-color:white;
	border:none;
}
.delClass:hover{
	background-color:#F6F1EF;
}
.reStartClass:hover{
	background-color:#F6F1EF;
}
.goD:hover{
	cursor: pointer;
	background-color:#F6F1EF;
}

</style>
</head>

<body>


<div id='naviBar'></div>

<!-- 왼쪽 네비바 -->
<div id="layoutSidenav">
    <div id="layoutSidenav_nav">
    	<nav class="sb-sidenav accordion sb-sidenav-dark" id="leftMenuNav">
            <div class="sb-sidenav-menu">
                <div class="nav">
                    <div class="sb-sidenav-menu-heading">Manager Page</div>
                    <a class="nav-link" href="javascript:void(0);" id="goClassList">
                        <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                        Class List
                    </a>
                    <a class="nav-link" href="javascript:void(0);" id="goUserList">
                        <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                        Users
                    </a>
                    <a class="nav-link" href="javascript:void(0)" id="goQnaList">
                        <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                        Questions
                    </a>
                   
                </div>
            </div>
        </nav>
    </div>
   
    <div id="layoutSidenav_content">
          <main>
            <div class="container-fluid">
                <h1 class="mt-4" id="managerPage">Manager Page</h1>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="fas fa-table mr-1"></i>
                   		One-Day Class List
                    </div>
                    <!-- 메인 컨텐츠 -->
                    <div class="card-body" >
                    <div class="table-responsive">
                    	<div class="row">
                    		<div class="col-sm-12 col-md-6">
                     		<div id="dataTable_filter" class="dataTables_filter">
                     			<label>
                     				<table>
                     					<tr>
                     						<td>NAME&nbsp;:&nbsp; </td>
                     						<td><input type="search" id="userName" class="form-control form-control-sm" placeholder aria-controls="dataTable">
                     						<input type="search" id="className" class="form-control form-control-sm" placeholder aria-controls="dataTable"></td>
                     						<td>:&nbsp;<button type="button" id="btnClassSearch" class="btn btn-light">search</button></td>
                     					</tr>
                     				</table>
                     			</label>
                     		</div>
                    		</div>
                    	</div>
                        
                       <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                           <tbody id="classList"></tbody>
                       </table>
                       <div class="container" id="userPagination">
							<nav aria-label="Page navigation">
								<ul class="userPagination" style="justify-content:center;"></ul>
							</nav>
					    </div>
					    <div class="container" id="classPagination">
							<nav aria-label="Page navigation">
								<ul class="classPagination" style="justify-content:center;"></ul>
							</nav>
					    </div>
                      </div>
                    </div>
                    <!-- ///////////// 메인 컨텐츠 끝 ///////////// -->
                   </div>
               </div>
           </main>
     </div>       



    <div id="noticeCheckCheck">
          	<div style="padding-top: 100px;">
			<!--검색 -->
			<div class="search">
				<table style="margin: auto;">
					<tr>
						<td style="padding-left: 5px">
							<select id="_choice" name="choice" class="form-select">
								<option value="" selected="selected">검색 선택</option>
								<option value="title">제목</option>
								<option value="content">내용</option>
								<option value="writer">작성자</option>
							</select>
						</td>
						<td style="padding-left: 5px">
							<input type="text" id="_searchWord" name="searchWord">
						</td>
						<td style="padding-left: 5px">
							<span class="button blue">
								<button type="button" id="btnSearch" class="btn btn-secondary">검색</button>
							</span>
						</td>
					</tr>
				</table>
			</div>
			<!-- 테이블 -->
			<div class="mainTable">
				<table class="customTable" id="noticeTable">
					<colgroup>			
						<col style="width:70px">
						<col style="width:70px">
						<col style="width:70px">
						<col style="width:70px">
					</colgroup>	
					
					<tr>
						<th>번호</th><th>제목</th><th>작성자</th><th>이메일</th>
					</tr>
					
				</table>
			</div>
		
			<br><br>

			<div class="container">
				<nav aria-label="Page navigation">
					<ul class="pagination" style="justify-content:center;"></ul>
				</nav>
			</div>
		</div>
     </div>
</div>             
 

                   





        
<!-- 문의 디테일 모달 -->
<div id="detailModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
			<table class="customTable" id="detailTable">
				<tr>
					<th>문의번호</th>
					<td><input type='text' size="20" id="_noticeNum" name="noticeNum" readonly="readonly"></td>
				</tr>
				<tr>
					<th>유저번호</th>
					<td><input type='text' size="20" id="_memNum" name="memNum" readonly="readonly"></td>
				</tr>
		        <tr>
		        <th>유저네임</th>
		        <td><input type='text' size="20" id="_username" name="detailUsername" readonly="readonly"></td>
		        </tr>
		         <tr>
		        <th>이메일</th>
		        <td><input type='text' size="20" id="_email" name="detalEmail" readonly="readonly"></td>
		        </tr>
		        <tr>
		        <th>제목</th>
		        <td><input type='text' size="20" id="_ntitle" name="title" readonly="readonly"></td>
		        </tr>
		        <tr>
					<th>작성일</th>
					<td><input type='text' size="20" id="_wdate" name="wdate" readonly="readonly"></td>
				</tr>
				
				<tr>
		        <th>내용</th>
		        <td><textarea rows="10" cols="30" id="_ncontent" name="content" readonly="readonly"></textarea>
		        
		        </tr>
		        <tr><th>첨부이미지</th>
		        <td><img id="_nImg" alt='no image' src=''></td>
		        </tr>
		        
		          
          	</table>
            </div>
            <div class="modal-footer">
           
            	<input type="button" class="btn btn-secondary" id="updatebtn" value="수정">
            	<input type="button" class="btn btn-secondary" id="answerbtn" value="답변하기">
            	<button type="button" class="btn btn-secondary" id="deletebtn">삭제</button>
                <button type="button" class="btn btn-secondary" id="closebtn">Close</button>
            </div>
        </div>
    </div>
</div>	


<div id='footer'></div>

<!-- <script src="demo/datatables-demo.js"></script> -->

 
<script type="text/javascript">
$("#naviBar").load("../navibar.html");
$("#footer").load("../footer.html");


$(document).ready(function () {

	goClassList();	
	
	$("#goClassList").on('click', function(){
		goClassList();
	});
	
	$("#goUserList").on('click',function(){
		goUserList();
	});


	//--------------------------사이드 유저리스트 검색했을 때
	function goUserList(){	
		$("#layoutSidenav_content").show();
		$("#noticeCheckCheck").hide();
		
		$('#userName').show();
		$("#className").hide();
		
		$("#userPagination").show();
		$("#classPagination").hide();
		$('#btnClassSearch').attr('id', 'btnSearchUser');
	   	$(".card-header").text("User List");
	  	$("#managerPage").text("User List");

	   
	   $("#dataTable").empty();
	   let table = "<thead>"
	            + "<tr>"
	            + "<th>#</th>"
	            + "<th>이름</th>"
	            + "<th>닉네임</th>"
	            + "<th>마스터</th>"
	            + "<th>포인트</th>"
	            + "<th>이메일</th>"
	            + "<th>전화번호</th>"
	            + "</tr>"
	            + "</thead>";
	   
	            $("#dataTable").append(table);
	            $("#dataTable").append("<tbody id='classList'></tbody>"); // 태그 추가

	
	            getUserListData(0);
	            countUserList();
	}
	
	// 처음에 유저목록 다 보여줌
	function getUserListData(pgNumber){
		//$("#mainScr").load("../adminPageView/adminCListUList.html");
	      $.ajax({
	         url:"http://localhost:3000/memlist",
	         type:"get",
	         data:{ name:$("#userName").val(), page:pgNumber},
	         success:function(list){
	            //alert(list);
	            $('.classtrtrtr').remove();
	            $('.usertrtrtr').remove();
	            $.each(list, function(i, list){
	               let str = "<tr class='usertrtrtr'>"
	                     + "<td>" + (i+1) + "</td>"
	                     + "<td>" + list.userName + "</td>"
	                     + "<td>" + list.nickName + "</td>"
	                     + "<td>" + list.classMaster + "</td>"
	                     + "<td>" + list.myPoint + "</td>"
	                     + "<td>" + list.email + "</td>"
	                     + "<td>" + list.phoneNum + "</td>"
	                     + "</tr>";
	               $("#classList").append(str);                  
	            });         
	            
	         
	            $("#memDelete").click(function(){
	               alert($("#memDelete").val());               
	            });
	            
	         },
	         error:function(){
	            alert('userlist실패쓰ㅜ');
	         }
	      });
	}
	            
	function countUserList() {
		$.ajax({
			url:"http://localhost:3000/userCount",
			type:"get",
			data:{page:0, name:$("#userName").val()},
			success:function(count){
				loadPage3(count);
			},
			error:function(){
				alert("우짜냐 에러다ㅜ");
			}
		}); 
	}
	
	//paging class 처리
	function loadPage3( totalCount ) {
	
		let pageSize = 10;
		let nowPage = 1;
		
		let _totalPages = totalCount / pageSize;
		if(totalCount % pageSize > 0){
			_totalPages++;
		}
		$(".userPagination").twbsPagination('destroy'); //페이지 갱신: 초기화
		
		$(".userPagination").twbsPagination({
		//	startPage: 1,
			totalPages: _totalPages,
			visiblePages: 10,
			first:'<span sria-hidden="true">«</span>',
			prev:"이전",
			next:"다음",
			last:'<span sria-hidden="true">»</span>',
			initiateStartPageClick:false,		// onPageClick 자동 실행되지 않도록 한다
			onPageClick:function(event, page){
				nowPage = page;
			//	alert('nowPage:' + page);
				getUserListData( page - 1 );
			}
		});	
	}
	
	// 유저 이름 검색했을 때 
	$(document).on("click", "#btnSearchUser", function () { 
		 getUserListData(0);
         countUserList();
	});
	
	
	
	
	
	
	
	//----------------------------사이드바  원데이 클래스 클릭시 
	function goClassList(){
	    //$("#mainScr").load("../adminPageView/adminCListUList.html");
		$("#layoutSidenav_content").show();
		$("#noticeCheckCheck").hide();
		
		$('#userName').hide();
		$("#className").show();
		
		$("#userPagination").hide();
		$("#classPagination").show();
		$(".card-header").text("One-Day Class List");
		$("#managerPage").text("One-Day Class List");
		$("#dataTable").empty();
		   let table = "<thead>"
		            + "<tr>"
		            + "<th>#</th>"
		            + "<th>개설자</th>"
		            + "<th>제목</th>"
		            + "<th>대분류</th>"
		            + "<th>소분류</th>"
		            + "<th>수업 시작일</th>"
		            + "<th>수업 종료일</th>"
		            + "<th>장소</th>"
		            + "<th>중단/재개</th>"
		            + "</tr>"
		            + "</thead>";
		   

		    $("#dataTable").append(table);
		    $("#dataTable").append("<tbody id='classList'></tbody>"); // 태그 추가
	
		    $('#btnUserSearch').attr('id', 'btnClassSearch');    
					
		    classlist(0);
		    countClassList();
		        
	}            
		
	//----------- 클래스 리스트 뿌리기------------
	function classlist(pNum) {
		$.ajax({
			url:"http://localhost:3000/classlist",
			type:"get",
			data:{ name:$("#className").val(), page:pNum},
			success:function(list){
				
				$('.classtrtrtr').remove();
				$('.usertrtrtr').remove();
				
				$.each(list, function(i, list){
					
					let startDate = (list.startDate).substring(0, 10);
					let endDate = (list.endDate).substring(0, 10);
					let del = "";
					
			        if(list.del==0)
						del = "<td><input type='button' seq="+list.classNum+" class='delClass' value='중단'></td>"
					else if(list.del==1)
						del = "<td><input type='button' seq="+list.classNum+" class='reStartClass' value='재개'></td>"
					
					let str = "<tr class='classtrtrtr'>"
							+ "<td>" + (i+1) + "</td>"
							+ "<td>" + list.instructor + "</td>"
							+ "<td class='goD' seq="+list.classNum+">" + list.title + "</td>"
							+ "<td>" + list.primaryCategory + "</td>"
							+ "<td>" + list.secondaryCategory + "</td>"
							+ "<td>" + startDate + "</td>"
							+ "<td>" + endDate  + "</td>"
							+ "<td>" + list.location + "</td>"
							+ del
							+ "</tr>";
					$("#classList").append(str);	
				});
				
				// 클래스 중단
				$('.delClass').on('click',function(){
					let check = confirm('정말로 중단하겠습니다');
					let seq = $(this).attr('seq');
					if(check){
						$.ajax({
							url:"http://localhost:3000/onedayClassDelete",
							type:"get",
							data:{classNum:seq},
							success:function(result){
								if(result){
									alert('성공적으로 중단했습니다');
									location.reload();									
								}
							},
							error:function(){
								alert("onedayClassMasterDel ajax error");
							}
						}); 
					}
				}); 
				
				// 클래스 재개
				$('.reStartClass').on('click',function(){
					let check = confirm('정말로 재개하겠습니까');
					let seq = $(this).attr('seq');
					if(check){
						$.ajax({
							url:"http://localhost:3000/onedayClassRestart",
							type:"get",
							data:{classNum:seq},
							success:function(result){
								if(result){
									alert('성공적으로 재개하였습니다');
									location.reload();									
								}
							},
							error:function(){
								alert("onedayClassMasterDel ajax error");
							}
						}); 
					}
				}); 
				
				// 클래스 수정
				$(".goD").click(function(){
					let seq = $(this).attr('seq');
					location.href="../onedayClassView/onedayClassUpdate.html?seq="+seq;
				})
				
			},
			error:function(){
				alert('classlist ajax error');
			}		
				
		});	
	}

	function countClassList() {
		$.ajax({
			url:"http://localhost:3000/classCount",
			type:"get",
			data:{page:0, name:$("#className").val()},
			success:function(count){
				loadPage2(count);
			},
			error:function(){
				alert("우짜냐 에러다ㅜ");
			}
		}); 
	}
	//paging class 처리
	function loadPage2( totalCount ) {
	
		let pageSize = 10;
		let nowPage = 1;
		
		let _totalPages = totalCount / pageSize;
		if(totalCount % pageSize > 0){
			_totalPages++;
		}
		$(".classPagination").twbsPagination('destroy'); //페이지 갱신: 초기화
		
		$(".classPagination").twbsPagination({
		//	startPage: 1,
			totalPages: _totalPages,
			visiblePages: 10,
			first:'<span sria-hidden="true">«</span>',
			prev:"이전",
			next:"다음",
			last:'<span sria-hidden="true">»</span>',
			initiateStartPageClick:false,		// onPageClick 자동 실행되지 않도록 한다
			onPageClick:function(event, page){
				nowPage = page;
			//	alert('nowPage:' + page);
				classlist( page - 1 );
			}
		});	
	}
	// 검색했을때 리스트
	$("#btnClassSearch").on("click", function () { 
		classlist(0);
	    countClassList();
	});
}); 



//----------------------문의사항----------------------------



	$("#goQnaList").click(function(){
		$(".card-header").text("QnA List");
		$("#managerPage").text("QnA List");
		adminNoticeCheck();
	});

	function adminNoticeCheck() {
		$("#layoutSidenav_content").hide();
		$("#noticeCheckCheck").show();
		let loginid;

		noticeListData(0);

		noticeListCount();
		
		//seq받아오기
		let urlParams = location.search.split(/[?&]/).slice(1).map(function(paramPair) {
		    return paramPair.split(/=(.+)?/).slice(0, 2);
		}).reduce(function(obj, pairArray) {
		    obj[pairArray[0]] = pairArray[1];
		    return obj;
		}, {});
	}
	function noticeListData( pNumber ) {
		
		$.ajax({
			url:"http://localhost:3000/noticeListData",
			type:"get",
			data:{ page:pNumber, choice:$("#_choice").val(), search:$("#_searchWord").val() },
			success:function( list ){
				//alert('success');
				//alert(list);
				
				
				$(".list_col").remove();
			
				$.each(list, function (i, val) {
					let app = "<tr class='list_col'>"
								+ "<td>" + (i + 1) + "</td>"
								+ "<td>";
								
						if(val.del == 0){	// 삭제되지 않은 글	
							app += "<a href='javascript:;' id='_seq' value='"+val.noticeNum+"'>&nbsp;" 
							+ val.nTitle + "</a>";
						}else{				// 삭제된 글
							app += "<font color='#ff0000'>* 이 글은 작성자에 의해서 삭제되었습니다 *</font>";
						}
						app += "</td>";
						
						app += "<td>" + val.username + "</td>";
						app += "<td>" + val.email + "</td>"; 
						app += "</tr>";
							
					$("#noticeTable").append(app);	
				});	
				
				
			},
			error:function(){
				alert('error');
			}
		});
	}

	//글의 총수를 취득
	function noticeListCount() {
		
		$.ajax({
			url:"http://localhost:3000/noticeListCount",
			type:"get",
			data:{ page:0, choice:$("#_choice").val(), search:$("#_searchWord").val() },
			success:function( count ){
				//alert('success');
				loadPage(count);
				
			},
			error:function(){
				alert('error');
			}		
		});
	}

	//paging 처리
	function loadPage( totalCount ) {

		let pageSize = 10;
		let nowPage = 1;
		
		let _totalPages = totalCount / pageSize;
		if(totalCount % pageSize > 0){
			_totalPages++;
		}
		$(".pagination").twbsPagination('destroy'); //페이지 갱신: 초기화
		
		$(".pagination").twbsPagination({
		//	startPage: 1,
			totalPages: _totalPages,
			visiblePages: 10,
			first:'<span sria-hidden="true">«</span>',
			prev:"이전",
			next:"다음",
			last:'<span sria-hidden="true">»</span>',
			initiateStartPageClick:false,		// onPageClick 자동 실행되지 않도록 한다
			onPageClick:function(event, page){
				nowPage = page;
			//	alert('nowPage:' + page);
				noticeListData( page - 1 );
			}
		});	
	}

	//아이디..
/* 	$(document).ready(function () {

		let login = sessionStorage.getItem("login");
		let json = JSON.parse(login); // String -> json
		//alert(json.id);
		let loginid = json.id;
		$("#_wid").val(json.id);	
	});	
		 */
	//검색	
	$(document).on("click", "#btnSearch", function () {


		
			noticeListData(0);

			noticeListCount();
		
	});
	//디테일 show up
	$(document).on("click", "#_seq", function () { 
		var tseq=$(this).attr('value');
		//alert('click');
		//alert(tseq);
		//let seq = urlParams.seq;
		//alert("seq: " + seq);
		
		$.ajax({
			url:"http://localhost:3000/noticeDetail",
			type:"get",
			data:{seq:tseq },
			success:function( bbs ){
				//alert('success');
				
				$("#_noticeNum").val(bbs.noticeNum);
				$("#_memNum").val(bbs.memNum);
				$("#_username").val(bbs.username);
				$("#_ntitle").val(bbs.nTitle);
				$("#_ncontent").val(bbs.nContent);
				$("#_wdate").val(bbs.wDate);
				$("#_email").val(bbs.email);
				var src1 = './noticeUpload/' + bbs.nImg;
				
				$("#_nImg").attr("src", src1);
				
				$("#detailModal").modal('show');
			},
			error:function(){
				alert('error');
			}		
			
			});
		
		});

	//답변클릭시 나오는 행
	let reply = "<tr id='replyTr'><th>답변</th><td><textarea rows='10' cols='30' id='replyMessage'name='message'></textarea></td></tr>";
	//답변 버튼 클릭 
	$(document).on("click", "#answerbtn", function () { 

		
					
		$("#detailTable").append(reply);	
		
		$('#answerbtn').hide(); //답변클릭시 답변버튼 지움
		$(".modal-footer").append("<button type=\"button\" class=\"btn btn-secondary\" id=\"answerAf\">답변완료</button>");			
	});



	//모달 닫기 버튼
	$(document).on("click", "#closebtn", function () { 
		$('#replyTr').remove();
		$('#answerAf').remove();
		$('#answerbtn').show();
		$('#detailModal').modal('hide');
		adminNoticeCheck();
	});

	</script> 
	<!-- 이메일 -->
	<script type="text/javascript">
		
		$(document).ready(function() {
			emailjs.init("user_ZyFYDtGep3QSZfIgncD2e");		
	       
			$(document).on("click", '#answerAf', function(){       	 
				$(this).remove();
				$("#detailModal").modal('hide');
				
				
	          var templateParams = {	
	          //각 요소는 emailJS에서 설정한 템플릿과 동일한 명으로 작성!
	                username: $('.detailUsername').val(),
	                email : $('.detailEmail').val(),
	                message : $('.message').val()
	           				};
	                    
	                	
	         emailjs.send('service_9lc0w1h', 'template_2s4zzav', templateParams)
	         //emailjs.send('service ID', 'template ID', 보낼 내용이 담긴 객체)
	         	    .then(function(response) {
	         	    	alert('success');
	         	       console.log('SUCCESS!', response.status, response.text);
	         	     
	         	    }, function(error) {
	         	       console.log('FAILED...', error);
	         	    });
	         	       

				
	         $.ajax({
	  	 		url:"http://localhost:3000/noticeAnswerAf",
	  	 		type:"get",
	  	 		data:{seq:$('#_noticeNum').val() },
	  	 		success:function( data ){
	  	 			alert('success');

	  	 			adminNoticeCheck();
	  	 			
	  	 		},
	  	 		error:function(){
	  	 			alert('error');
	  	 			}
	  	 	});
	         
	         
	        });
		  });

		</script>
</body>
</html>
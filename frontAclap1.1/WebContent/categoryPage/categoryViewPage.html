<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<!-- pagination -->
<script type="text/javascript" src="../js/jquery.twbsPagination.min.js"></script>
<link rel="stylesheet" href="../css/categoryCss.css">


<!-- jquary -->
<script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- icon -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>




</head>

<body>
<script type="text/javascript">
$("#naviBar").load("../navibar.html");
$("#footer").load("../footer.html");
</script>

<div id='naviBar'></div>
<div class="mainViewW">
<!-- Primary Category -->
	<div class="midClassMenu">
		<ul class="navListTop2">
			<li class="listItem2"><a class="categoryA langLink" id="allClass" eng="전체" href="javascript:void(0);">
			<i class="fas fa-language" style="font-size:46px;"></i><br>전체보기</a></li>
			<li class="listItem2"><a class="categoryA langLink" id="langClass" eng="외국어" href="javascript:void(0);">
			<i class="fas fa-language" style="font-size:46px;"></i><br>외국어</a></li>
			<li class="listItem2"><a class="categoryA createLink" id="createClass" eng="크리에이티브" href="javascript:void(0);">
			<i class="fas fa-palette" style="font-size:46px;"></i><br>크리에이티브</a></li>
			<li class="listItem2"><a class="categoryA cookingLink" id="cookingClass" eng="요리" href="javascript:void(0);">
			<i class="fas fa-utensils" style="font-size:46px;"></i><br>요리</a></li>
			<li class="listItem2"><a class="categoryA programmingLink" id="programmingClass" eng="프로그래밍" href="javascript:void(0);">
			<i class="fas fa-code" style="font-size:46px;"></i><br>프로그래밍</a></li>
			<li class="listItem2"><a class="categoryA sportsLink" id="sportsClass" eng="스포츠/레져" href="javascript:void(0);">
			<i class="fas fa-dumbbell" style="font-size:46px;"></i><br>스포츠/레져</a></li>
	    </ul>

	</div>
	
		<!-- 기본메인 -->
	<div class="categoryPage allClassMain" id="allCView">
		
		<div class="allClass">

		
		
			<!-- 정렬 셀렉트 및 검색 창 -->
			<div class="selectAndSearch">
			
				<div class="select">
				  <select name="choice" id="allChoice">
				    <option selected disabled>정렬 기준 선택</option>
				    <option value="orderByLike">인기순</option>
				    <option value="orderByRecent">최신순</option>
				    <option value="orderByAvg">평점순</option>
				  </select>
				</div>
				
				<div class="search-box">
				  <input class="search-input" id="allSearchWord" type="text" placeholder="검색어 입력">
				  <a href="#" id="allBtnSearch" class="search-btn">
				    <i class="fas fa-search"></i>
				  </a>     
				</div>
				
			</div>
			<!-- 리스트 가져오기 및 뿌려주기부분 -->
			<div class="searchedClassListView">
			
				<div class="classListTable">
					
				</div>
				
			
			</div>
		</div>	
		
		
	</div>
	
	
	<!-- 외국어 -->
	<div class="categoryPage langClassMain" id="langCView">
		
		<div class="langClass">
			

			<!-- 배너공간 -->
			<div id="carouselExampleIndicators1" class="carousel slide" data-ride="carousel">
			  <ol class="carousel-indicators">
			    <li data-target="#carouselExampleIndicators1" data-slide-to="0" class="active"></li>
			    <li data-target="#carouselExampleIndicators1" data-slide-to="1"></li>
			    <li data-target="#carouselExampleIndicators1" data-slide-to="2"></li>
			  </ol>
			  <div class="carousel-inner">
			    <div class="carousel-item active">
			      <img src="../images/main4.png" class="d-block w-100" alt="...">
			    </div>
			    <div class="carousel-item">
			      <img src="../images/취미1.png" class="d-block w-100" alt="...">
			    </div>
			    <div class="carousel-item">
			      <img src="../images/취미2.png" class="d-block w-100" alt="...">
			    </div>
			  </div>
			  <a class="carousel-control-prev" href="#carouselExampleIndicators1" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#carouselExampleIndicators1" role="button" data-slide="next">
			    <span class="carousel-control-next-icon"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
		
		<!-- 정렬 셀렉트 및 검색 창 -->
		<div class="selectAndSearch">
		
			<div class="select">
			  <select name="choice" id="langChoice">
			    <option selected disabled>정렬 기준 선택</option>
			    <option value="orderByLike">인기순</option>
			    <option value="orderByRecent">최신순</option>
			    <option value="orderByAvg">평점순</option>
			  </select>
			</div>
			
			<div class="search-box">
			  <input class="search-input" id="langSearchWord" type="text" placeholder="검색어 입력">
			  <a href="#" id="langBtnSearch" class="search-btn">
			    <i class="fas fa-search"></i>
			  </a>     
			</div>
			
		</div>
		<!-- 리스트 가져오기 및 뿌려주기부분 -->
		<div class="searchedClassListView">
		
			<div class="classListTable">
				
			</div>
			
		</div>
			
		</div>
		
	</div>
	
	<!-- 크리에이티브 -->
	<div class="categoryPage createClassMain" id="creCView">
		
		<div class="createClass">
		
			
			
			<!-- 정렬 셀렉트 및 검색 창 -->
			<div class="selectAndSearch">
			
				<div class="select">
				  <select name="choice" id="createChoice">
				    <option selected disabled>정렬 기준 선택</option>
				    <option value="orderByLike">인기순</option>
				    <option value="orderByRecent">최신순</option>
				    <option value="orderByAvg">평점순</option>
				  </select>
				</div>
				
				<div class="search-box">
				  <input class="search-input" type="text" id="createSearchWord" name="" placeholder="검색어 입력">
				  <a href="#" id="createBtnSearch" class="search-btn">
				    <i class="fas fa-search"></i>
				  </a>     
				</div>
				
			</div>
			
			<!-- 리스트 가져오기 및 뿌려주기부분 -->
			<div class="searchedClassListView">
			
				<div class="classListTable">
	
				</div>
				
			
	
			
			</div>
			
		</div>
		
	</div>
	
	<!-- 요리 -->
	<div class="categoryPage cookingClassMain" id="cooCView">
		
		<div class="cookingClass">
		
			
			
			<!-- 정렬 셀렉트 및 검색 창 -->
			<div class="selectAndSearch">
			
				<div class="select">
				  <select name="choice" id="cookChoice">
				    <option selected disabled>정렬 기준 선택</option>
				    <option value="orderByLike">인기순</option>
				    <option value="orderByRecent">최신순</option>
				    <option value="orderByAvg">평점순</option>
				  </select>
				</div>
				
				<div class="search-box">
				  <input class="search-input" type="text" id="cookSearchWord"  name="" placeholder="검색어 입력">
				  <a href="#" id="cookBtnSearch" class="search-btn">
				    <i class="fas fa-search"></i>
				  </a>     
				</div>
				
			</div>
			
			<!-- 리스트 가져오기 및 뿌려주기부분 -->
			<div class="searchedClassListView">
			
				<div class="classListTable">
					
				</div>
				
			
			</div>
			
		</div>
		
	</div>
	
	<!-- 프로그래밍 -->
	<div class="categoryPage programmingClassMain" id="proCView">
		
		<div class="programmingClass">
		
			
			
				<!-- 정렬 셀렉트 및 검색 창 -->
			<div class="selectAndSearch">
			
				<div class="select">
				  <select name="choice" id="programChoice">
				    <option selected disabled>정렬 기준 선택</option>
				    <option value="orderByLike">인기순</option>
				    <option value="orderByRecent">최신순</option>
				    <option value="orderByAvg">평점순</option>
				  </select>
				</div>
				
				<div class="search-box">
				  <input class="search-input" type="text" id="programSearchWord" name="" placeholder="검색어 입력">
				  <a href="#" id="programBtnSearch" class="search-btn">
				    <i class="fas fa-search"></i>
				  </a>     
				</div>
				
			</div>
			
			<!-- 리스트 가져오기 및 뿌려주기부분 -->
			<div class="searchedClassListView">
			
				<div class="classListTable">
				
				</div>
				
			
	
			
			
			</div>
			
		</div>
		
	</div>
	
	<!-- 스포츠/레져 -->
	<div class="categoryPage sportsClassMain" id="spoCVIew">
			
		<div class="sportsClass">
		
			
			
				<!-- 정렬 셀렉트 및 검색 창 -->
			<div class="selectAndSearch">
			
				<div class="select">
				  <select name="choice" id="sportChoice">
				    <option selected disabled>정렬 기준 선택</option>
				    <option value="orderByLike">인기순</option>
				    <option value="orderByRecent">최신순</option>
				    <option value="orderByAvg">평점순</option>
				  </select>
				</div>
				
				<div class="search-box">
				  <input class="search-input" type="text" id="sportSearchWord"  name="" placeholder="검색어 입력">
				  <a href="#" id="sportBtnSearch"class="search-btn">
				    <i class="fas fa-search"></i>
				  </a>     
				</div>
				
			</div>
			
			<!-- 리스트 가져오기 및 뿌려주기부분 -->
			<div class="searchedClassListView">
			
				<div class="classListTable">
				
				</div>
				
	
			</div>
			
		</div>
		
	</div>	
	






</div>

<div id='footer'></div>


<script type="text/javascript">
	$("#naviBar").load("../navibar.html");
	$("#footer").load("../footer.html");
$(document).ready(function(){
	
	$('.allClassMain').show();
	$('.langClassMain').hide();
	$('.createClassMain').hide();
	$('.cookingClassMain').hide();
	$('.programmingClassMain').hide();
	$('.sportsClassMain').hide();
	
	
	/* 전체보기 눌렀을때 */
	$('#allClass').click(function () {
		$('.allClassMain').hide();
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		
		
		
		$('.allClassMain').show();
		$('.allClassMain').addClass('pt-page-moveFromRight');

		  
	});
	
	/* 대분류 외국어 눌렀을때 */
	$('#langClass').click(function () {
		$('.allClassMain').hide();
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		
		
		$('.langClassMain').show();
		$('.langClassMain').addClass('pt-page-moveFromRight');

		  
	});
	
	
	
	$('#createClass').click(function () {
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		$('.allClassMain').hide();
		
		
		  $('.createClassMain').show();
		  $('.createClassMain').addClass('pt-page-moveFromLeft');
	});
	
	$('#cookingClass').click(function () {
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		$('.allClassMain').hide();
		
		$('.cookingClassMain').show();
		$('.cookingClassMain').addClass('pt-page-moveFromBottom');
	});
	
	$('#programmingClass').click(function () {
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		$('.allClassMain').hide();

		$('.programmingClassMain').show();
		$('.programmingClassMain').addClass('pt-page-moveFromTop');
	});	
	
	$('#sportsClass').click(function () {
		$('.langClassMain').hide();
		$('.createClassMain').hide();
		$('.cookingClassMain').hide();
		$('.programmingClassMain').hide();
		$('.sportsClassMain').hide();
		$('.allClassMain').hide();

		$('.sportsClassMain').show();
		
		$('.sportsClassMain').addClass('pt-page-moveFromLeft');
	});	
	
	
});


//클래스 리스트 가져오기


let mySearch = $("#allSearchWord").val();
let myChoice = $("#allChoice").val();
classListData(0, myChoice, mySearch, '');

$(document).on("click", ".categoryA", function () { 
	let pcVal=$(this).attr('eng');
	
	if (pcVal=='전체'){
		pcVal = ''
		mySearch = $("#allSearchWord").val();
		myChoice = $("#allChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#allBtnSearch').click(function () {
			mySearch = $("#allSearchWord").val();
			myChoice = $("#allChoice").val();
			
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	
	if (pcVal=='외국어'){
		pcVal = '외국어'
		mySearch = $("#langSearchWord").val();
		myChoice = $("#langChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#langBtnSearch').click(function () {
			mySearch = $("#langSearchWord").val();
			myChoice = $("#langChoice").val();
			
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	if (pcVal=='크리에이티브'){
		pcVal = '크리에이티브'
		mySearch = $("#createSearchWord").val();
		myChoice = $("#createChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#createBtnSearch').click(function () {
			mySearch = $("#createSearchWord").val();
			myChoice = $("#createChoice").val();
			
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	if (pcVal=='요리'){
		pcVal = '요리'
		mySearch = $("#cookSearchWord").val();
		myChoice = $("#cookChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#cookBtnSearch').click(function () {
			mySearch = $("#cookSearchWord").val();
			myChoice = $("#cookChoice").val();
			//alert('검색한 값:' + mySearch);
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	if (pcVal=='프로그래밍'){
		pcVal = '프로그래밍'
		mySearch = $("#programSearchWord").val();
		myChoice = $("#programChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#programBtnSearch').click(function () {
			mySearch = $("#programSearchWord").val();
			myChoice = $("#programChoice").val();
			//alert('검색한 값:' + mySearch);
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	if (pcVal=='스포츠/레져'){
		pcVal = '스포츠레저'
		mySearch = $("#sportSearchWord").val();
		myChoice = $("#sportChoice").val();
		classListData(0, myChoice, mySearch, pcVal);
		$('#sportBtnSearch').click(function () {
			mySearch = $("#sportSearchWord").val();
			myChoice = $("#sportChoice").val();
			
			classListData(0, myChoice, mySearch, pcVal);
			//classListCount(myChoice, mySearch, pcVal);
		});
	}
	
});

function classListData( pNumber, myChoice, mySearch, pcVal ) {
	
	$.ajax({
		url:"http://localhost:3000/classListData",
		type:"get",
		
		data:{ page:pNumber, choice:myChoice, search:mySearch, primaryCategory: pcVal  },
		success:function( list ){
			//alert(list);
			//alert('success');
			$(".classCard").remove();
			let app ='';
			$.each(list, function (i, val) {
				let startDD = val.startDate;
				startDD = startDD.substring(0,10);
				//<img class='classImg' src='"+val.image1+"' alt='no image'>"
				app = "<div class='classCard'><img class='classImg' src='./images/eventImg3.jpg' alt='no image' align='center'>";
				app += "<div class='classContainer'>";
				app += "<font>라이크: " + val.likeCount + "평점: "+val.avgPoint+"</font>";
				app += "<h4><b>" + val.title + "</b></h4>";
				app += "<font>" + val.primaryCategory + "/" + val.secondaryCategory + "</font><br>";
				app += "<font> 포인트: " + val.price + "</font>";
				app += "</div></div>";
				
				$(".classListTable").append(app);
			});
			
			
			
			
		},
		error:function(){
			alert('error');
		}
	});
}

//글의 총수를 취득
function classListCount(myChoice, mySearch, pcVal) {
	
	$.ajax({
		url:"http://localhost:3000/classListCount",
		type:"get",
		data:{ page:0, choice:myChoice, search:mySearch, primaryCategory: pcVal },
		success:function( count ){
			//alert('success');
			alert('카운트시작');
			//loadPage(count);
		},
		error:function(){
			alert('error');
		}		
	});
}

//paging 처리
function loadPage( totalCount ) {

	let pageSize = 5;
	let nowPage = 1;
	
	let _totalPages = totalCount / pageSize;
	if(totalCount % pageSize > 0){
		_totalPages++;
	}
	$(".pagination").twbsPagination('destroy'); //페이지 갱신: 초기화
	
	$(".pagination").twbsPagination({
	//	startPage: 1,
		totalPages: _totalPages,
		visiblePages: 5,
		first:'<span sria-hidden="true">«</span>',
		prev:"이전",
		next:"다음",
		last:'<span sria-hidden="true">»</span>',
		initiateStartPageClick:false,		// onPageClick 자동 실행되지 않도록 한다
		onPageClick:function(event, page){
			nowPage = page;
			classListData(page - 1, myChoice, mySearch, pcVal);
		}
	});	
}
</script>


</body>
</html>